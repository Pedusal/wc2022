filter(!is.na(veikkaus[,6])
)
}
for (iii in 1:length(veikkaus$...2)) {
veikkaustaulu[1,1+iii] <-    c(paste(as.character(veikkaus$...6[iii]),
"-",
as.character(veikkaus$...8[iii])))
}
########################################
########## Lisataan veikkaukset veikkaustauluun #########
## haetaan yksittainen veikkaus kasittelyyn
if (length(veikkaukset)) {
for (uu in 2:(length(veikkaukset))) {
veikkaus <- data.frame(veikkaukset[uu])
veikkaus <- veikkaus %>%
filter(!is.na(veikkaus[,6])
)
## lisataan veikkaajan rivi veikkaustauluun
for (iii in 1:length(pelit)) {
veikkaustaulu[uu,1+iii] <-    c(paste(as.character(veikkaus$...6[iii]),
"-",
as.character(veikkaus$...8[iii])))
}
}
}
library(formattable)
library(dplyr)
#library(knitr)
as.datatable(
formattable(
veikkaustaulu,
list(
area(row=1) ~ formatter("span",
style = ~ style(color = "green", font.weight = "bold"))
)
)
,
#selection = 'none', #filter = 'none',
rownames = '',
extensions = c(#'Buttons',
'FixedColumns'),
options = list(
dom = 't',
columnDefs = list(list(
className = 'dt-center', targets = 3:length(pelit)-1)),
scrollX = TRUE,
#scrollCollapse = TRUE,
fixedColumns = list(leftColumns = 2)
)
)
library(formattable)
library(dplyr)
as.datatable(
formattable(maalintekijat)
,
options = list(
dom = 't',
columnDefs = list(list(
className = 'dt-center',
targets = length(maalintekijat[1,]))
),
scrollX = TRUE,
scrollCollapse = TRUE,
fixedColumns = list(leftColumns = 2)
)
)
################# piirretaan final4taulu
as.datatable(
formattable(final4taulu)
,
options = list(
dom = 't',
columnDefs = list(list(
className = 'dt-center',
targets = 1:5)
),
scrollX = TRUE,
#scrollCollapse = TRUE,
fixedColumns = list(leftColumns = 2)
)
)
url <- "https://nr.soccerway.com/international/world/world-cup/2022-qatar/group-stage/r49519/"
session <- bow(url)
library(rvest)   # 0.3.5
library(polite)  # 0.1.1
library(dplyr)   # 0.8.5
library(tidyr)   # 1.0.2
library(purrr)   # 0.3.4
library(stringr) # 1.4.0
library(glue)    # 1.4.0
library(rlang)   # 0.4.6
session <- bow(url)
session
team_links <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12_match-3298974 > td.score-time > a") %>%
html_attr("href")
team_links[[1]]
team_links
View(veikkaustaulu)
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12") %>%
html_attr("href")
teams
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign") %>%
html_attr("href")
teams
teams <- scrape(session) %>%
html_nodes("##page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody > tr:nth-child(1)") %>%
html_attr("href")
teams <- scrape(session) %>%
html_nodes("##page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody") %>%
html_attr("href")
teams <- scrape(session) %>%
html_nodes("##page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign") %>%
html_attr("href")
teams <- scrape(session) %>%
html_nodes("##page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign")
teams <- scrape(session) %>%
html_nodes("##page_competition_1_block_competition_matches_summary_12") %>%
html_attr("href")
teams <- scrape(session) %>%
html_nodes("##page_competition_1_block_competition_matches_summary_12")
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12")
teams
View(teams)
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody")
View(teams)
xml_child(teams[[1]], 1)
teams[[1]]
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody") %>%
html_attr("href")
teams
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody")
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody") %>%
html_attr("td")
teams
teams <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_matches_summary_12 > div.table-container.redesign > table > tbody") %>%
html_attr("class")
teams
url <- "https://us.soccerway.com/national/england/premier-league/20182019/regular-season/r48730/"
session <- bow(url)
session
team_links <- scrape(session) %>%
html_nodes("#page_competition_1_block_competition_tables_8_block_competition_league_table_1_table .large-link a") %>%
html_attr("href")
team_links[[1]]
team_links
team_links <- scrape(session) %>%
html_nodes("#team_rank_row_676 > td.text.team.large-link > a") %>%
html_attr("href")
team_links
team_links_df <- team_links %>%
tibble::enframe(name = NULL) %>%
## separate out each component of the URL by / and give them a name
tidyr::separate(value, c(NA, NA, NA, "team_name", "team_num"), sep = "/") %>%
## glue together the "team_name" and "team_num" into a complete URL
mutate(link = glue("https://us.soccerway.com/teams/england/{team_name}/{team_num}/squad/"))
glimpse(team_links_df)
url1 <- "https://www.google.com/search?q=world+cup+live+score+2022&oq=world+cup+live&aqs=chrome.3.69i57j0i19i512l9.11383j0j4&sourceid=chrome&ie=UTF-8#sie=lg;/m/0fp_8fm;2;/m/030q7;mt;fp;1;;;"
session <- bow(url)
session1 <- bow(url1)
session1
url1 <- "https://www.soccer24.com/world/world-cup/fixtures/"
session1 <- bow(url1)
session1
team_links1 <- scrape(session1) %>%
html_nodes("#live-table > div.event.mobile.event--fixtures > div > div")
team_links
team_links1
View(team_links1)
team_links1 <- scrape(session1) %>%
html_nodes("#live-table > div.event.mobile.event--fixtures > div > div") %>%
html_attr("id")
team_links1 <- scrape(session1) %>%
html_nodes("#live-table > div.event.mobile.event--fixtures > div > div")
View(team_links1)
team_links1
pg <- read_html("https://www.soccer24.com/world/world-cup/fixtures/")
links <- html_nodes(pg, "id")
pg <- read_html("https://www.livescores.com/football/world-cup/?tz=2")
links <- html_nodes(pg, "a")
View(links)
bind_rows(lapply(xml_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
library(rvest)
bind_rows(lapply(xml_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
library(rvest)
bind_rows(lapply(xml_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
library(dplyr)
bind_rows(lapply(xml_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
bind_rows(lapply(html_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
a <- bind_rows(lapply(html_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(a)
links <- html_nodes(pg, "#content-center > div")
a <- bind_rows(lapply(html_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(a)
url1 <- "https://www.livescores.com/football/world-cup/?tz=2"
session1 <- bow(url1)
session1
team_links1 <- scrape(session1) %>%
html_nodes("#content-center > div")
View(team_links1)
xml_child(team_links1[[1]], 1)
a <- bind_rows(lapply(html_attrs(team_links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
a <- bind_rows(lapply(html_attrs(team_links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(links)
View(en_fi_country_colors)
team_links1 <- scrape(session1) %>%
html_nodes("#content-center > div")
View(team_links1)
a <- bind_rows(lapply(html_attrs(links), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(a)
a <- bind_rows(lapply(html_attrs(team_links1), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(a)
xml <-  xmlTreeParse("tean_links1", useInternalNodes=TRUE)
install.packages("xml")
library(xml)
install.packages("XML")
library(XML)
library(XML)
xml <-  xmlTreeParse("tean_links1", useInternalNodes=TRUE)
xml <-  xmlTreeParse(team_links1, useInternalNodes=TRUE)
xpathApply(team_links1, "//level4name", xmlValue)
team_links1 <- scrape(session1) %>%
html_nodes("#content-center > div > div:nth-child(3)")
View(team_links1)
a <- bind_rows(lapply(html_attrs(team_links1), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(a)
team_links1 <- scrape(session1) %>%
html_nodes("#content-center > div")
a <- bind_rows(lapply(html_attrs(team_links1), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(team_links1)
install.packages("xml2")
install.packages("xml2")
install.packages("xml2")
install.packages("xml2")
install.packages("xml2")
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
include = FALSE
)
getwd()
tulokset <- read_excel("Data/11oikearivi.xlsx")
library(xml2)
library(xml2)
xml_find_all(team_links1, xpath = "a")
xml_structure(team_links1)
team_links1 <- scrape(session1)
```{r pressure, echo=FALSE}
library(rvest)
library(dplyr)
library(XML)
library(xml2)
team_links1 <- scrape(session1)
team_links1 <- scrape(session1) %>%
html_nodes("#content-center > div")
library(rvest)   # 0.3.5
library(polite)  # 0.1.1
library(dplyr)   # 0.8.5
library(tidyr)   # 1.0.2
library(purrr)   # 0.3.4
library(stringr) # 1.4.0
library(glue)    # 1.4.0
library(rlang)   # 0.4.6
library(XML)
library(xml2)
library(rvest)   # 0.3.5
library(polite)  # 0.1.1
library(dplyr)   # 0.8.5
library(tidyr)   # 1.0.2
library(purrr)   # 0.3.4
library(stringr) # 1.4.0
library(glue)    # 1.4.0
library(rlang)   # 0.4.6
library(XML)
library(xml2)
team_links1 <- scrape(session1) %>%
xml_structure(team_links1)
team_links1 <- scrape(session1)
# combine above into one list
resultados <- list(team_name, avg_age, avg_value, team_img)
url1 <- "https://www.livescores.com/football/world-cup/?tz=2"
session1 <- bow(url1)
team_links1 <- scrape(session1)
xml_structure(team_links1)
xml_find_all(team_links1, xpath = "a")
xml_find_all(team_links1, xpath = "//a")
li <- xml_find_all(team_links1, xpath = "//a")
View(li)
a <- bind_rows(lapply(html_attrs(li), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
View(a)
a %>% filter(href = "	/football/zambia/?tz=2")
a %>% filter(href == "	/football/zambia/?tz=2")
View(a)
a <- a %>% filter(href == "	/football/zambia/?tz=2")
a <- bind_rows(lapply(html_attrs(li), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
a %>% filter(grepl('group', href))
a <- a %>% filter(grepl('group', href))
a <- a %>% filter(grepl('group&vs', href))
a <- bind_rows(lapply(html_attrs(li), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
a <- a %>% filter(grepl('vs', href))
a <- a %>% filter(class == "Td")
url1 <- "https://www.livescores.com/football/world-cup/?tz=2"
session1 <- bow(url1)
team_links1 <- scrape(session1) %>%
html_nodes("#content-center > div")
li <- xml_find_all(team_links1, xpath = "//a")
a <- bind_rows(lapply(html_attrs(li), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
a <- a %>% filter(grepl('group', href))
a <- a %>% filter(grepl('vs', href))
a <- a %>% filter(class == "Td")
View(team_links1)
url <- "https://www.livescores.com/football/world-cup/?tz=2"
session <- bow(url)
sessio_html <- scrape(session) %>%
html_nodes("#content-center > div")
#content-center > div > div:nth-child(3)
linkki_df <- xml_find_all(sessio_html, xpath = "//a")
linkit <- bind_rows(lapply(html_attrs(linkki_df), function(x) data.frame(as.list(x), stringsAsFactors=FALSE)))
linkit <- linkit %>% filter(grepl('group', href))
linkit <- linkit %>% filter(grepl('vs', href))
linkit <- linkit %>% filter(class == "Td")
View(linkit)
url1 <- "https://us.soccerway.com/national/england/premier-league/20182019/regular-season/r48730/"
session1 <- bow(url1)
team_links <- scrape(session1) %>%
html_nodes("#page_competition_1_block_competition_tables_8_block_competition_league_table_1_table .large-link a") %>%
html_attr("href")
team_links <- scrape(session1) %>%
html_nodes("#team_rank_row_676 > td.text.team.large-link > a") %>%
html_attr("href")
team_links_df <- team_links %>%
tibble::enframe(name = NULL)
View(team_links_df)
%>%
ottelut_links_df <- linkit %>%
## separate out each component of the URL by / and give them a name
tidyr::separate(href, c(NA, NA, NA, "lohko", "ottelu","ottelu_id", NA), sep = "/") %>%
## glue together the "team_name" and "team_num" into a complete URL
mutate(link = glue("https://www.livescores.com/football/world-cup/{lohko}/{ottelu}/{ottelu_id}/?tz=2/"))
View(ottelut_links_df)
glimpse(team_links_df)
glimpse(ottelut_links_df)
View(ottelut_links_df)
session <- bow(https://www.livescores.com/football/world-cup/group-a/qatar-vs-ecuador/587251/?tz=2/)
session <- bow("https://www.livescores.com/football/world-cup/group-a/qatar-vs-ecuador/587251/?tz=2/")
ottelu_pvm_info <- scrape(session) %>%
html_nodes("#__livescore > div:nth-child(8) > span:nth-child(2)") %>%
html_text()
ottelu_time_info <- scrape(session) %>%
html_nodes("#__livescore > div.he.ke > span.ie") %>%
html_text()
home_goals_info <- scrape(session) %>%
html_nodes("#__livescore > div.he.ke > div.oe") %>%
html_text()
#session <- bow("https://www.livescores.com/football/world-cup/group-a/qatar-vs-ecuador/587251/?tz=2/")
fottelu_pvm <- function(session) {
ottelu_pvm_info <- scrape(session) %>%
html_nodes("#__livescore > div:nth-child(8) > span:nth-child(2)") %>%
html_text()
}
fottelu_time <- function(session) {
ottelu_time_info <- scrape(session) %>%
html_nodes("#__livescore > div.he.ke > span.ie") %>%
html_text()
}
fhome_goals <- function(session) {
home_goals_info <- scrape(session) %>%
html_nodes("#__livescore > div.he.ke > div.oe") %>%
html_text()
## first value is blank so remove it
#num_assists_info_clean <- num_assists_info[-1]
}
faway_goals <- function(session) {
away_goals_info <- scrape(session) %>%
html_nodes("#__livescore > div.he.ke > div.oe") %>%
html_text()
## first value is blank so remove it
#num_assists_info_clean <- num_assists_info[-1]
}
ottelu_info <- function(link, ottelu_name) {
ottelu_name <- rlang::enquo(ottelu_name)
## `bow()` for every URL link
session <- bow(link)
## scrape different stats
ottelu_pvm <- fottelu_pvm(session = session)
ottelu_time <- fottelu_time(session = session)
home_goals <- fhome_goals(session = session)
away_goals <- faway_goals(session = session)
## combine stats into a data frame
resultados <- list(ottelu_pvm, ottelu_pvm, home_goals, away_goals)
col_names <- c("ottelu_pvm", "ottelu_pvm", "home_goals", "away_goals")
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names) %>%
mutate(ottelu = !!ottelu_name)
## A little message to keep track of how the function is progressing:
# cat(team_name, " done!")
return(premier_stats)
}
safe_ottelut_info <- safely(ottelut_info)
safe_ottelut_info <- safely(ottelut_info)
fottelut_info <- function(link, ottelu_name) {
ottelu_name <- rlang::enquo(ottelu_name)
## `bow()` for every URL link
session <- bow(link)
## scrape different stats
ottelu_pvm <- fottelu_pvm(session = session)
ottelu_time <- fottelu_time(session = session)
home_goals <- fhome_goals(session = session)
away_goals <- faway_goals(session = session)
## combine stats into a data frame
resultados <- list(ottelu_pvm, ottelu_pvm, home_goals, away_goals)
col_names <- c("ottelu_pvm", "ottelu_pvm", "home_goals", "away_goals")
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names) %>%
mutate(ottelu = !!ottelu_name)
## A little message to keep track of how the function is progressing:
# cat(team_name, " done!")
return(premier_stats)
}
safe_ottelut_info <- safely(fottelut_info)
ottelut_tulokset_df_ALL <- map2(.x = ottelut_links_df$link, .y = ottelus_links_df$ottelu,
~ safe_ottelut_info(link = .x, ottelut = .y))
ottelut_tulokset_df_ALL <- map2(.x = ottelut_links_df$link, .y = ottelut_links_df$ottelu,
~ safe_ottelut_info(link = .x, ottelut = .y))
glimpse(head(ottelut_tulokset_df_ALL, 4))
View(ottelut_tulokset_df_ALL)
a <- fottelut_info("https://www.livescores.com/football/world-cup/group-a/qatar-vs-ecuador/587251/?tz=2/", "qat-ecu")
link <- "https://www.livescores.com/football/world-cup/group-a/qatar-vs-ecuador/587251/?tz=2/"
ottelu_name <- "qat-ec"
ottelu_name <- rlang::enquo(ottelu_name)
session <- bow(link)
ottelu_pvm <- fottelu_pvm(session = session)
ottelu_time <- fottelu_time(session = session)
home_goals <- fhome_goals(session = session)
away_goals <- faway_goals(session = session)
resultados <- list(ottelu_pvm, ottelu_pvm, home_goals, away_goals)
col_names <- c("ottelu_pvm", "ottelu_pvm", "home_goals", "away_goals")
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names) %>%
mutate(ottelu = !!ottelu_name)
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names) %>%
mutate(game = !!ottelu_name)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
include = FALSE
)
library(rvest)   # 0.3.5
library(polite)  # 0.1.1
library(dplyr)   # 0.8.5
library(tidyr)   # 1.0.2
library(purrr)   # 0.3.4
library(stringr) # 1.4.0
library(glue)    # 1.4.0
library(rlang)   # 0.4.6
library(XML)
library(xml2)
getwd()
tulokset <- read_excel("Data/11oikearivi.xlsx")
install.packages("rlang")
install.packages("rlang")
library(rlang)   # 0.4.6
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names) %>%
mutate(game = !!ottelu_name)
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names)
View(premier_stats)
premier_stats <- resultados %>%
reduce(cbind) %>%
as_tibble() %>%
set_names(col_names) %>%
mutate(game = ottelu_name)
remove.packages(rlang)
remove.packages("rlang")
library(rlang)
installed.packages("rlang")
installed.packages("rlang")
install.packages("rlang")
install.packages("rlang")
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
include = FALSE
)
library(rvest)   # 0.3.5
library(rlang)   # 0.4.6
install.packages("rlang")
